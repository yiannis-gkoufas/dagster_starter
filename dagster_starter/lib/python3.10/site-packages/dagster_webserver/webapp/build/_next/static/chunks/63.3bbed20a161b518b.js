(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63],{96795:function(e,n,t){var r=t(36740)(function(e,n,t){e[t?0:1].push(n)},function(){return[[],[]]});e.exports=r},78945:function(e,n,t){"use strict";t.d(n,{_:function(){return useCanSeeConfig}});var r=t(73235),u=t(40794),i=t(60138);function _templateObject(){var e=(0,r._)(["\n  query InstanceConfigHasInfo {\n    instance {\n      id\n      hasInfo\n    }\n  }\n"]);return _templateObject=function(){return e},e}var useCanSeeConfig=function(){var e=(0,u.a)(s).data;return!!(null==e?void 0:e.instance.hasInfo)},s=(0,i.Ps)(_templateObject())},46928:function(e,n,t){"use strict";t.d(n,{Q1:function(){return b},Qf:function(){return useSelectedRunsTab},zc:function(){return useRunListTabs}});var r=t(85333),u=t(6692),i=t(58467),s=t(73235),o=t(82550),l=t(52322),a=t(40794),c=t(60138),d=t(9001),f=t(86412),p=t(18149),m=t.n(p),h=t(2784),v=t(7267),R=t(35505),_=t(28252),j=t(16148),g=t(6315),x=t(49313);function _templateObject(){var e=(0,s._)(["\n  ","\n"]);return _templateObject=function(){return e},e}function _templateObject1(){var e=(0,s._)(["\n  query RunTabsCountQuery($queuedFilter: RunsFilter!, $inProgressFilter: RunsFilter!) {\n    queuedCount: pipelineRunsOrError(filter: $queuedFilter) {\n      ... on Runs {\n        count\n      }\n    }\n    inProgressCount: pipelineRunsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        count\n      }\n    }\n  }\n"]);return _templateObject1=function(){return e},e}var getDocumentTitle=function(e){switch(e){case"all":return"Runs | All runs";case"failed":return"Runs | Failed";case"in-progress":return"Runs | In progress";case"queued":return"Runs | Queued";case"scheduled":return"Runs | Scheduled";default:return"Runs"}},useRunListTabs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,a.a)(y,{variables:{queuedFilter:(0,u._)((0,r._)({},e),{statuses:Array.from(g.sy)}),inProgressFilter:(0,u._)((0,r._)({},e),{statuses:Array.from(g.Ys)})}}),t=n.data,s=h.useMemo(function(){var e,n;return{queuedCount:(null==t?void 0:null===(e=t.queuedCount)||void 0===e?void 0:e.__typename)==="Runs"?t.queuedCount.count:null,inProgressCount:(null==t?void 0:null===(n=t.inProgressCount)||void 0===n?void 0:n.__typename)==="Runs"?t.inProgressCount.count:null}},[t]),c=s.queuedCount,f=s.inProgressCount,p=(0,i._)((0,x.oD)(),1)[0],m=useSelectedRunsTab(p);(0,_.j)(getDocumentTitle(m));var urlForStatus=function(e){var n=p.filter(function(e){return"status"!==e.token}),t=e.map(function(e){return{token:"status",value:e}});return(0,x.it)((0,o._)(t).concat((0,o._)(n)))};return{tabs:(0,l.jsxs)(d.zH,{children:[(0,l.jsx)(b,{to:urlForStatus([]),id:"all",$active:"all"===m,children:"All runs"}),(0,l.jsxs)(b,{to:urlForStatus(Array.from(g.sy)),id:"queued",$active:"queued"===m,children:["Queued (",null!=c?c:"indeterminate",")"]}),(0,l.jsxs)(b,{to:urlForStatus(Array.from(g.Ys)),id:"in-progress",$active:"in-progress"===m,children:["In progress (",null!=f?f:"indeterminate",")"]}),(0,l.jsx)(b,{to:urlForStatus(Array.from(g.hd)),id:"failed",$active:"failed"===m,children:"Failed"}),(0,l.jsx)(b,{title:"Scheduled",to:"/runs/scheduled",id:"scheduled",$active:"scheduled"===m,children:"Scheduled"})]}),queryResult:n}},b=(0,R.ZP)(j.A).withConfig({componentId:"sc-8862b5f1-0"})(_templateObject(),function(e){return e.$active&&"\n    background: ".concat(f.w.Gray200,";\n  ")}),useSelectedRunsTab=function(e){var n=(0,v.TH)().pathname;if("/runs/timeline"===n)return"timeline";if("/runs/scheduled"===n)return"scheduled";if("/overview/backfills"===n)return"backfills";var t=new Set(e.filter(function(e){return"status"===e.token}).map(function(e){return e.value}));return m()(g.sy,t)?"queued":m()(g.Ys,t)?"in-progress":m()(g.hd,t)?"failed":"all"},y=(0,c.Ps)(_templateObject1())},5063:function(e,n,t){"use strict";t.r(n),t.d(n,{RUNS_ROOT_QUERY:function(){return V},RunsRoot:function(){return RunsRoot},default:function(){return M}});var r=t(85333),u=t(58467),i=t(73235),s=t(82550),o=t(52322),l=t(60138),a=t(18399),c=t(21221),d=t(28888),f=t(17131),p=t(81308),m=t(92364),h=t(12084),v=t(83302),R=t(96795),_=t.n(R),j=t(2784),g=t(91195),x=t(55237),b=t(68028),y=t(28316);function DOMNodeHost(e){var n=e.node,t=j.useRef(null);return j.useLayoutEffect(function(){var e=t.current;if(n.parentNode!==e){if(null!==n.parentNode&&n.parentNode!==e)throw Error("Cannot render the same node twice");return null==e||e.appendChild(n),function(){null==e||e.removeChild(n)}}},[n]),(0,o.jsx)("div",{ref:t})}var C=t(90894),O=t(19358),q=t(40794),T=t(9676),E=t(47933),A=t(74897),F=t(78945);function _templateObject(){var e=(0,i._)(['\n  query QueueDaemonStatusQuery {\n    instance {\n      id\n      daemonHealth {\n        id\n        daemonStatus(daemonType: "QUEUED_RUN_COORDINATOR") {\n          id\n          daemonType\n          healthy\n          required\n        }\n      }\n    }\n  }\n']);return _templateObject=function(){return e},e}var QueuedRunsBanners=function(){var e=(0,F._)();return(0,o.jsxs)(a.x,{flex:{direction:"column",gap:8},style:{minWidth:"100%"},border:"bottom",children:[e&&(0,o.jsx)(T.b,{intent:"info",title:(0,o.jsx)(E.rU,{to:"/config#run_coordinator",children:"View queue configuration"})}),e&&(0,o.jsx)(QueueDaemonAlert,{})]})},QueueDaemonAlert=function(){var e=(0,q.a)(S).data,n=j.useContext(A.N).pageTitle,t=null==e?void 0:e.instance.daemonHealth.daemonStatus;return(null==t?void 0:t.required)&&!(null==t?void 0:t.healthy)?(0,o.jsx)(T.b,{intent:"warning",title:"The queued run coordinator is not healthy.",description:(0,o.jsxs)("div",{children:["View ",(0,o.jsx)(E.rU,{to:"/health",children:n})," for details."]})}):null},S=(0,l.Ps)(_templateObject()),k=t(46928),w=t(6315),P=t(46253),$=t(38917),Q=t(49313),I=t(81862),B=t(22970),D=t(56675),N=t(9001),H=t(18149),U=t.n(H),Y=t(16322);function TerminateAllRunsButton_templateObject(){var e=(0,i._)(["\n  query TerminateRunIdsQuery($filter: RunsFilter!) {\n    pipelineRunsOrError(filter: $filter) {\n      ... on Runs {\n        results {\n          id\n          status\n          canTerminate\n        }\n      }\n    }\n  }\n"]);return TerminateAllRunsButton_templateObject=function(){return e},e}var TerminateAllRunsButton=function(e){var n,t=e.refetch,r=e.filter,i=e.disabled,s=(0,u._)(j.useState(null),2),l=s[0],a=s[1],c=(0,D.x)(),d=(n=(0,I._)(function(){var e;return(0,B.Jh)(this,function(n){switch(n.label){case 0:return[4,c.query({query:L,variables:{filter:r}})];case 1:return a("Runs"===(e=n.sent()).data.pipelineRunsOrError.__typename?Object.fromEntries(e.data.pipelineRunsOrError.results.map(function(e){return[e.id,e.canTerminate]})):{}),[2]}})}),function(){return n.apply(this,arguments)});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Y.A,{isOpen:null!==l,selectedRuns:l||{},selectedRunsAllQueued:U()(r,{statuses:Array.from(w.sy)}),onClose:function(){return a(null)},onComplete:function(){return t()}}),(0,o.jsx)(N.zx,{intent:"danger",outlined:!0,disabled:i,onClick:d,children:"Terminate allâ€¦"})]})},L=(0,l.Ps)(TerminateAllRunsButton_templateObject()),z=t(65767);function RunsRoot_templateObject(){var e=(0,i._)(["\n  query RunsRootQuery($limit: Int, $cursor: String, $filter: RunsFilter!) {\n    pipelineRunsOrError(limit: $limit, cursor: $cursor, filter: $filter) {\n      ... on Runs {\n        results {\n          id\n          ...RunTableRunFragment\n        }\n      }\n      ... on InvalidPipelineRunsFilterError {\n        message\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return RunsRoot_templateObject=function(){return e},e}var RunsRoot=function(){var e,n,t,actionBar=function(){var e,n,t,r;return(0,o.jsxs)(a.x,{style:{width:"100%",marginRight:8},flex:{justifyContent:"space-between"},children:[(0,o.jsxs)(a.x,{flex:{direction:"row",alignItems:"center",gap:8},children:[M,et]}),"queued"===F?(0,o.jsx)(TerminateAllRunsButton,{refetch:G.refetch,filter:{statuses:Array.from(w.sy)},disabled:(null===(e=Z.data)||void 0===e?void 0:e.queuedCount.__typename)!=="Runs"||(null===(n=Z.data)||void 0===n?void 0:n.queuedCount.count)===0}):"in-progress"===F?(0,o.jsx)(TerminateAllRunsButton,{refetch:G.refetch,filter:{statuses:Array.from(w.Ys)},disabled:(null===(t=Z.data)||void 0===t?void 0:t.inProgressCount.__typename)!=="Runs"||(null===(r=Z.data)||void 0===r?void 0:r.inProgressCount.count)===0}):void 0]})};(0,b.Px)();var i=(0,u._)((0,Q.oD)(),2),l=i[0],R=i[1],g=(0,Q.VH)(l),q=(0,z.l)({nextCursorForResult:function(e){var n;if("Runs"===e.pipelineRunsOrError.__typename)return null===(n=e.pipelineRunsOrError.results[24])||void 0===n?void 0:n.id},getResultArray:function(e){return e&&"Runs"===e.pipelineRunsOrError.__typename?e.pipelineRunsOrError.results:[]},variables:{filter:g},query:V,pageSize:25}),T=q.queryResult,E=q.paginationProps,A=(0,x.C4)(T,x.dT),F=(0,k.Qf)(l),S="all"!==F,I=(0,u._)(_()(l,function(e){return"status"===e.token}),2),B=I[0],D=I[1],N=j.useCallback(function(e){S?R((0,s._)(B).concat((0,s._)(e))):R(e)},[R,S,B]),H=j.useCallback(function(e){var n=(0,c.HY)(e);D.some(function(e){return(0,c.HY)(e)===n})||N((0,s._)(D).concat([e]))},[D,N]),U=j.useMemo(function(){var e=["tag","snapshotId","id","job","pipeline","backfill"];return S||e.push("status"),e},[S]),Y=j.useMemo(function(){return S?l.filter(function(e){return"status"!==e.token}):l},[l,S]),L=(0,k.zc)(g),M=L.tabs,Z=L.queryResult,J=(0,x.C4)(Z,x.dT),G=(0,x.V5)(J,A),W=(0,Q.Vv)({tokens:Y,onChange:N,enabledFilters:U}),X=W.button,K=W.activeFiltersJsx,ee=(0,u._)((n=(e=(0,u._)(j.useState(null),2))[0],t=e[1],j.useLayoutEffect(function(){t(function(e){return null===e?document.createElement("div"):e})},[]),[n?(0,y.createPortal)(X,n):null,n?(0,o.jsx)(DOMNodeHost,{node:n}):null]),2),en=ee[0],et=ee[1];return(0,o.jsxs)(d.T,{children:[(0,o.jsx)(f.m,{title:(0,o.jsx)(p.X6,{children:"Runs"}),right:(0,o.jsx)(x.xi,{refreshState:G})}),en,(0,o.jsx)($.Lw.Provider,{value:{refetch:T.refetch},children:(0,o.jsx)(C.g,{queryResult:T,allowStaleData:!0,renderError:function(e){var n=!!((null==e?void 0:e.networkError)&&"statusCode"in e.networkError&&400===e.networkError.statusCode);return(0,o.jsxs)(a.x,{flex:{direction:"column",gap:32},padding:{vertical:8,left:24,right:12},children:[actionBar(),(0,o.jsx)(m.t,{icon:"warning",title:n?"Invalid run filters":"Unexpected error",description:n?"The specified run filters are not valid. Please check the filters and try again.":"An unexpected error occurred. Check the console for details."})]})},children:function(e){var n=e.pipelineRunsOrError;return"Runs"!==n.__typename?(0,o.jsx)(a.x,{padding:{vertical:64},children:(0,o.jsx)(m.t,{icon:"error",title:"Query Error",description:n.message})}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(O.Y,{$top:0,children:(0,o.jsx)(P.AL,{runs:n.results.slice(0,25),onAddTag:H,filter:g,actionBarComponents:actionBar(),belowActionBarComponents:"queued"===F||K.length?(0,o.jsxs)(o.Fragment,{children:["queued"===F&&(0,o.jsx)(QueuedRunsBanners,{}),K.length>0&&(0,o.jsxs)(o.Fragment,{children:[K,(0,o.jsx)(h.Z,{onClick:function(){return N([])},children:"Clear all"})]})]}):null})}),n.results.length>0?(0,o.jsx)("div",{style:{marginTop:"16px"},children:(0,o.jsx)(v.pI,(0,r._)({},E))}):null]})}})})]})},M=RunsRoot,V=(0,l.Ps)(RunsRoot_templateObject(),P.ZZ,g.B)}}]);
//# sourceMappingURL=63.3bbed20a161b518b.js.map