(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[948],{30733:function(t,e,n){var o=n(96738);function memoize(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var memoized=function(){var n=arguments,o=e?e.apply(this,n):n[0],r=memoized.cache;if(r.has(o))return r.get(o);var i=t.apply(this,n);return memoized.cache=r.set(o,i)||r,i};return memoized.cache=new(memoize.Cache||o),memoized}memoize.Cache=o,t.exports=memoize},26778:function(t,e,n){"use strict";function _array_like_to_array(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}function _unsupported_iterable_to_array(t,e){if(t){if("string"==typeof t)return _array_like_to_array(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(t,e)}}function _sliced_to_array(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n,o,r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i=[],a=!0,u=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}}(t,e)||_unsupported_iterable_to_array(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var o=n(46506),r=n(3440),i=n.n(r),a="group__",layoutAssetGraph=function(t,e){var n=new o.graphlib.Graph({compound:!0}),r=e.tightTree?"tight-tree":e.longestPath?"longest-path":"network-simplex";n.setGraph(e.horizontalDAGs?{rankdir:"LR",marginx:100,marginy:100,nodesep:-10,edgesep:90,ranksep:60,ranker:r}:{rankdir:"TB",marginx:100,marginy:100,nodesep:40,edgesep:10,ranksep:10,ranker:r}),n.setDefaultEdgeLabel(function(){return{}});var parentNodeIdForNode=function(t){return[a,t.definition.repository.location.name,t.definition.repository.name,t.definition.groupName].join("__")},shouldRender=function(t){return t},u=Object.values(t.nodes).filter(shouldRender),d={},s=!0,h=!1,l=void 0;try{for(var f,p=u[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var c=f.value;if(c.definition.groupName){var y=parentNodeIdForNode(c);d[y]={id:y,groupName:c.definition.groupName,repositoryName:c.definition.repository.name,repositoryLocationName:c.definition.repository.location.name,repositoryDisambiguationRequired:!1,bounds:{x:0,y:0,width:0,height:0}}}}}catch(t){h=!0,l=t}finally{try{s||null==p.return||p.return()}finally{if(h)throw l}}var m=Object.keys(d).length>1;m&&Object.keys(d).forEach(function(t){return n.setNode(t,{})}),u.forEach(function(t){n.setNode(t.id,getAssetNodeDimensions(t.definition)),m&&t.definition.groupName&&n.setParent(t.id,parentNodeIdForNode(t))});var g={};Object.entries(t.downstream).forEach(function(e){var o=_sliced_to_array(e,2),r=o[0];Object.keys(o[1]).forEach(function(e){(shouldRender(t.nodes[e])||shouldRender(t.nodes[r]))&&(n.setEdge({v:r,w:e},{weight:1}),shouldRender(t.nodes[e])?shouldRender(t.nodes[r])||(g[r]=!0):g[e]=!0)})}),Object.keys(g).forEach(function(t){var o=JSON.parse(t),r=o[o.length-1]||"";n.setNode(t,getAssetLinkDimensions(r,e))}),o.layout(n);var v=0,x=0,b={};if(n.nodes().forEach(function(t){var e=n.node(t);if(e){var o={x:e.x-e.width/2,y:e.y-e.height/2,width:e.width,height:e.height};t.startsWith(a)||(b[t]={id:t,bounds:o}),v=Math.max(v,e.x+e.width/2),x=Math.max(x,e.y+e.height/2)}}),m){var w=!0,_=!1,O=void 0;try{for(var E,N=u[Symbol.iterator]();!(w=(E=N.next()).done);w=!0){var k=E.value;if(k.definition.groupName){var I=d[parentNodeIdForNode(k)];I.bounds=0===I.bounds.width?b[k.id].bounds:extendBounds(I.bounds,b[k.id].bounds)}}}catch(t){_=!0,O=t}finally{try{w||null==N.return||N.return()}finally{if(_)throw O}}var M=!0,A=!1,S=void 0;try{for(var j,B=Object.values(d)[Symbol.iterator]();!(M=(j=B.next()).done);M=!0){var D=j.value;D.bounds=padBounds(D.bounds,{x:15,top:70,bottom:-10})}}catch(t){A=!0,S=t}finally{try{M||null==B.return||B.return()}finally{if(A)throw S}}}Object.values(i()(Object.values(d),function(t){return t.groupName})).filter(function(t){return t.length>1}).flat().forEach(function(t){t.bounds.y-=18,t.bounds.height+=18,t.repositoryDisambiguationRequired=!0});var z=[];return n.edges().forEach(function(t){var o=n.node(t.v),r=g[t.v]?16:24,i=n.node(t.w),a=g[t.w]?16:24;z.push(e.horizontalDAGs?{from:{x:o.x+o.width/2,y:o.y},fromId:t.v,to:{x:i.x-i.width/2-5,y:i.y},toId:t.w}:{from:{x:o.x-o.width/2+r,y:o.y-30+o.height/2},fromId:t.v,to:{x:i.x-i.width/2+a,y:i.y+20-i.height/2},toId:t.w})}),{nodes:b,edges:z,width:v+100,height:x+100,groups:m?d:{}}},getAssetLinkDimensions=function(t,e){return e.horizontalDAGs?{width:32+8*Math.min(10,t.length),height:90}:{width:106,height:90}},padBounds=function(t,e){return{x:t.x-e.x,y:t.y-e.top,width:t.width+2*e.x,height:t.height+e.top+e.bottom}},extendBounds=function(t,e){var n=Math.min(t.x,e.x),o=Math.min(t.y,e.y);return{x:n,y:o,width:Math.max(t.x+t.width,e.x+e.width)-n,height:Math.max(t.y+t.height,e.y+e.height)-o}},getAssetNodeDimensions=function(t){if(t.isSource&&!t.isObservable)return{width:265,height:102};var e=100;return t.isSource?e+=30:(e+=26,t.isPartitioned&&(e+=40)),{width:265,height:e+=30}},titleOfIO=function(t){return"result"!==t.solid.name?"".concat(t.solid.name,":").concat(t.definition.name):t.solid.name};function flattenIO(t){var e={};return t.forEach(function(t){return t.forEach(function(t){return e[titleOfIO(t)]=t})}),Object.values(e)}function layoutExternalConnections(t,e,n){var o=n-166,r=Math.max(200,o/t.length),i=83+Math.min(0,(o-t.length*r)/2),a=r<300?20:0,u={};return t.forEach(function(t,n){u[titleOfIO(t)]={x:i+n*r,y:e+a*(1-n%2*2)}}),u}function layoutOp(t,e){var n=e.y,appendMiniIODots=function(t,o,r){var i,a=((function(t){if(Array.isArray(t))return _array_like_to_array(t)})(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||_unsupported_iterable_to_array(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort(function(t,e){return o(t).localeCompare(o(e))}),u=0,d=null,s={},h=Math.min(35,370/(a.length+1));a.forEach(function(t,o){var a=r(t);a!==d?(d=a,i={port:{x:e.x+u+13,y:n+13},collapsed:[],label:!1,layout:{x:e.x+u,y:n,width:35,height:26}},s[t.definition.name]=i,u+=h):(0===i.collapsed.length&&(u+=15),i.collapsed.push(t.definition.name))});var l=(370-(u-13+35))/2;return Object.values(s).forEach(function(t){t.layout.x+=l,t.port.x+=l}),n+=26,s},appendStackedIOBoxes=function(t){var o={};return t.forEach(function(t){o[t.definition.name]={port:{x:e.x+13,y:n+13},label:!0,collapsed:[],layout:{x:e.x,y:n,width:0,height:26}},n+=26}),o},o=t.inputs.length>4?appendMiniIODots(t.inputs,function(t){return t.definition.name},function(t){var e;return(null===(e=t.dependsOn[0])||void 0===e?void 0:e.solid.name)||""}):appendStackedIOBoxes(t.inputs),r={x:e.x,y:Math.max(e.y,n-0),width:370,height:52};n+=52,t.definition.assetNodes.length&&t.definition.description&&(r.height+=22,n+=22);var i=t.outputs.length>4?appendMiniIODots(t.outputs,function(t){var e;return(null===(e=t.dependedBy[0])||void 0===e?void 0:e.definition.name)||""},function(t){var e;return(null===(e=t.dependedBy[0])||void 0===e?void 0:e.solid.name)||""}):appendStackedIOBoxes(t.outputs);return{bounds:{x:e.x-5,y:e.y-5,width:380,height:n-e.y+10},op:r,inputs:o,outputs:i}}self.addEventListener("message",function(t){var e=t.data;switch(e.type){case"layoutOpGraph":var n,r,i,a,u,d,s,h,l,f,p,c,y,m,g,v=e.ops,x=e.opts;self.postMessage((u=new o.graphlib.Graph,d=0,s=100,h=100,x.parentOp&&(s=(h=140)+(d=26*Math.max(x.parentOp.inputs.length,x.parentOp.outputs.length))),u.setGraph({rankdir:"TB",marginx:h,marginy:s}),u.setDefaultEdgeLabel(function(){return{}}),l=[],f={},v.forEach(function(t){f[t.name]=!0}),v.forEach(function(t){var e=layoutOp(t,{x:0,y:0});u.setNode(t.name,{width:e.bounds.width,height:e.bounds.height}),t.inputs.forEach(function(e){e.dependsOn.forEach(function(n){f[n.solid.name]&&f[t.name]&&(u.setEdge({v:n.solid.name,w:t.name},{weight:1}),l.push({from:{point:{x:0,y:0},opName:n.solid.name,edgeName:n.definition.name},to:{point:{x:0,y:0},opName:t.name,edgeName:e.definition.name}}))})})}),o.layout(u),p={},c={},u.nodes().forEach(function(t){var e=u.node(t);e&&(c[t]=e)}),y=0,m=0,Object.entries(c).forEach(function(t){var e=_sliced_to_array(t,2),n=e[0],o=e[1],r=v.find(function(t){return t.name===n});if(r){var i=o.x-o.width/2,a=o.y-o.height/2;p[n]=layoutOp(r,{x:i,y:a}),y=Math.max(y,i+o.width),m=Math.max(m,a+o.height)}}),u.edges().forEach(function(t){var e=l.find(function(e){return e.from.opName===t.v&&e.to.opName===t.w}),n=u.edge(t).points;e&&n.length>0&&(e.from.point=n[0],e.to.point=n[n.length-1])}),g={edges:l,nodes:p,width:y+h,height:m+s,parent:null},x.parentOp&&(g.parent=(n=x.parentOp,r=d,a=(i={invocationBoundingBox:{x:1,y:1,width:g.width-1,height:g.height-1},bounds:{x:70,y:70+r,width:g.width-140,height:g.height-(70+r)*2},mappingLeftEdge:50,mappingLeftSpacing:10,inputs:{},outputs:{},dependsOn:layoutExternalConnections(flattenIO(n.inputs.map(function(t){return t.dependsOn})),-50,g.width),dependedBy:layoutExternalConnections(flattenIO(n.outputs.map(function(t){return t.dependedBy})),g.height+50,g.width)}).bounds.y+i.bounds.height,n.inputs.forEach(function(t,e){i.inputs[t.definition.name]={layout:{x:i.bounds.x,y:i.bounds.y-26*e-26,width:0,height:26},collapsed:[],label:!0,port:{x:i.bounds.x+13,y:i.bounds.y-26*e-13}}}),n.outputs.forEach(function(t,e){i.outputs[t.definition.name]={layout:{x:i.bounds.x,y:a+26*e,width:0,height:26},collapsed:[],label:!0,port:{x:i.bounds.x+13,y:a+26*e+13}}}),i)),g));break;case"layoutAssetGraph":var b=e.graphData,w=e.opts;self.postMessage(layoutAssetGraph(b,w))}})}}]);
//# sourceMappingURL=948.2caba091ca647c64.js.map